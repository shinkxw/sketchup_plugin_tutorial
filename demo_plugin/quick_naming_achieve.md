# 命名分层功能实现

在前面完成的功能铺垫下，最后实现命名分层功能还是较为简单的，核心功能是在quick_naming.rb中的两个方法，分别是获取当前选中对象信息(名称与所在图层名)的`current_entity_info`与设置当前对象名称与图层的`set_current_entity_name_and_layer`，该方法会先检查当前模型中有没有进行图层的初始化，如果没有会先将设置界面中添加的图层数据按顺序全部创建，然后根据传入的名称与图层id为当前对象设置名称(包括定义名称)与对应的图层。

在local_server.rb与browser.rb文件中把这两个方法封装为接口可被前端调用后，开始编写前端的功能页面quick_naming.vue。这个页面需要获取两种数据，一个是在后台设置的配置数据，只需要在页面打开时获取一次，另一个当前选中对象的信息数据则需要多次获取，当前选择对象改变后，点击按钮修改名称与图层后都需要进行刷新。可以注意到在browser.rb文件中，`set_current_entity_name_and_layer`接口与观察者类的回调中均有`run_js(@type, "quick_naming.refresh_entity_info()")`语句，这个就是在SU中通过传递js语句给前端执行来刷新页面。
